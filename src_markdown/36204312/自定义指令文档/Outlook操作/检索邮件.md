## <font style="color:rgb(44, 62, 80);">描述</font>
<font style="color:rgb(44, 62, 80);">该指令实现了在 outlook 中根据指定条件检索邮件的功能</font>

![](https://cdn.nlark.com/yuque/0/2023/png/2820055/1686536321024-677b284c-0a07-4307-a4fe-331d1dafe166.png)

## <font style="color:rgb(44, 62, 80);">参数配置</font>
### <font style="color:rgb(44, 62, 80);">指令输入</font>
**<font style="color:rgb(44, 62, 80);">Outlook 对象:</font>**_<font style="color:rgb(44, 62, 80);">outlook 对象</font>_<font style="color:rgb(44, 62, 80);">; 已打开 outlook 软件返回的对象</font>

**<font style="color:rgb(44, 62, 80);">账户:</font>**_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">; 要使用的 Outlook 账户的对象, 为空表示使用第一个</font>

**<font style="color:rgb(44, 62, 80);">邮件数量:</font>**_<font style="color:rgb(44, 62, 80);">数字</font>_<font style="color:rgb(44, 62, 80);">; 检索邮件的数量, 此数量是指检索邮件的总数</font>

**<font style="color:rgb(44, 62, 80);">检索:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">下拉选择框</font>_<font style="color:rgb(44, 62, 80);">, 所有电子邮件, 仅未读邮件, 仅已读邮件</font>

**<font style="color:rgb(44, 62, 80);">标记为已读:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">复选框</font>_<font style="color:rgb(44, 62, 80);">, 是否将检索的邮件标记为已读</font>

**<font style="color:rgb(44, 62, 80);">发件人包含:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">, 选填, 根据发件人的邮箱地址检索</font>

**<font style="color:rgb(44, 62, 80);">收件人包含:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">, 选填, 根据收件人的邮箱地址检索</font>

**<font style="color:rgb(44, 62, 80);">主题包含:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">, 选填, 根据邮件主题关键字检索邮件</font>

**<font style="color:rgb(44, 62, 80);">正文包含:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">, 选填, 根据正文关键字检索邮件</font>

**<font style="color:rgb(44, 62, 80);">高级</font>**

**<font style="color:rgb(44, 62, 80);">自动同步邮件:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">复选框</font>_<font style="color:rgb(44, 62, 80);">, 是否从邮件服务器拉取最新的邮件</font>

**<font style="color:rgb(44, 62, 80);">保存附件:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">复选框</font>_<font style="color:rgb(44, 62, 80);">, 是否保存附件</font>

**<font style="color:rgb(44, 62, 80);">是否覆盖本地文件:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">复选框</font>_<font style="color:rgb(44, 62, 80);">, 保存附件时是否覆盖本地同名文件</font>

**<font style="color:rgb(44, 62, 80);">附件保存路径:</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">字符串</font>_<font style="color:rgb(44, 62, 80);">, 保存附件的文件夹路径</font>

### <font style="color:rgb(44, 62, 80);">指令输出</font>
**<font style="color:rgb(44, 62, 80);">保存邮件至</font>**<font style="color:rgb(44, 62, 80);"> </font>_<font style="color:rgb(44, 62, 80);">邮件的列表</font>_<font style="color:rgb(44, 62, 80);">; 将邮件相关信息保存至字典中并组成列表</font>

## <font style="color:rgb(44, 62, 80);">参考案例</font>
**<font style="color:rgb(44, 62, 80);">场景描述</font>**

<font style="color:rgb(44, 62, 80);">检索 3000 封邮件, 并将邮件的主题写入数据表格</font>

**<font style="color:rgb(44, 62, 80);">参考流程</font>**

![](https://cdn.nlark.com/yuque/0/2023/png/2820055/1686537708555-2d20835a-188e-45d8-87ae-fae340f62594.png)

**<font style="color:rgb(44, 62, 80);">关键指令配置</font>**

![](https://cdn.nlark.com/yuque/0/2023/png/2820055/1686537718360-161a4218-9895-43ef-a57a-b32924f3281b.png)

**<font style="color:rgb(44, 62, 80);">运行结果</font>**

![](https://cdn.nlark.com/yuque/0/2023/png/2820055/1686537851560-b9d9407d-066c-4a1c-b3fc-6e1e99bbbbf4.png)

